## [2022 카카오 사라지는 발판](https://school.programmers.co.kr/learn/courses/30/lessons/92345)

---

문제를 정의하는 것이 어려운 dfs 문제이다. 이런 류의 문제를 풀어 본 적이 없어서 질문을 참조했다.

문제에서는 A와 B를 '이길 수 있는 플레이어', '질 수 밖에 없는 플레이어' 로 표현한다. 이 표현에서 문맥을 헷갈려 게임의 시작부터 A와 B의 승패가 정해져 있는것으로 오해할 수 있는데, 실상은 다르다.

A와 B의 승패가 정해지는 것은 이길 수 있는 플레이어 쪽이 최선의 수를 두었을 때 뿐이며, 그렇지 않으면 '이길수 있는' 쪽이 질 수도 있다.

이말을 바꿔 말하면 A와 B의 승패는 게임의 시작부터가 아니라 도중에 정해질 수도 있다는 뜻이며, dfs의 특정 단계에서 승패가 결정된다는 의미이다.

이 승패는 dfs의 여러 가지에서 서로 다르게 나타난다. 어떤 가지에는 A가 이기고, 어떤 가지에는 B가 이길 것이며 각각의 이동횟수 cnt도 다르게 나타난다. 따라서 승패가 결정되는 것은 각각의 가지의 특정 단계에서라고 보는게 적절하다.

그렇다면 cnt 조건을 어떻게 정의해야 하는가? 문제에서는 "이길 수 있는 플레이어는 최대한 빨리 승리하도록 플레이한다." 라고 명시되어 있다. 즉 본인이 이길 수 있는 경우엔 이기는 수를 택하며, cnt를 최소화한다.

또한 "질 수밖에 없는 플레이어는 양 플레이어가 캐릭터를 움직이는 횟수를 최대화한다는 것을 의미한다" 라는 내용도 있다. 이말인 즉 본인이 이기는 경우의 수가 없고 무조건 지게 되는 경우, cnt를 최대화한다.

---

구현은 dfs를 사용했다. 해설에서는 a와 b 각각에 대한 함수를 만들어 서로를 호출하도록 하라 했지만, 하나의 함수에서 a와 b 인수를 번갈아가며 사용함으로써 하나의 함수로 구현할 수도 있다.

dfs의 처음엔 A가 이동한다. 현재 위치에서 상하좌우의 경우의 수를 두고 이동을 실행하며, cnt를 1 높이고 dfs의 A와 B를 바꾸어 다시 호출한다. 이러한 방법으로 A와 B가 번갈아가며 상하좌우를 이동하는 모든 경우의 수를 확인할 수 있다.

dfs의 끝은 게임이 끝나는 것과 동일하게 더 이상 이동할 공간이 없거나, 현재 위치한 곳이 0이 되는 경우이다. 이 경우 dfs는 해당 차례의 유저가 패배했다는 의미로 false와 이동거리 cnt를 리턴한다.

이렇게 리턴된 값 [승패, 이동거리] 는 이전 단계의 배열 bRes에 저장된다. 이 배열은 이번 단계에 본인이 상하좌우로 이동했을 때 상대방의 승패 여부와 이동 거리를 저장한 배열이다. 이 상대방의 승패 여부에 따라서 현재 단계에서 리턴할 값이 정해진다.

위에서 게임의 승패는 가지의 특정 단계부터 정해진다고 했다. dfs는 가지의 끝 즉 리프부터 리턴이 시작되므로, 리턴이 시작될 때는 이미 승패가 정해진 후 일것이다. 즉 이 단계에서 **'둘 중 하나의 플레이어는 어떤 수를 놔도 진다'**

이 단계에서 지는 쪽의 bRes의 win 값은 전부 true일 것이다. 이 말인 즉 이 단계에서부터 일어나는 모든 경우의 수는 상대방의 승리 즉 본인의 패배로 이어지고, 해당 플레이어가 '질 수밖에 없는 플레이어'가 된다는 것이다. '질 수밖에 없는 플레이어'는 cnt를 최대화시켜야 하기 때문에 주어진 bRes의 cnt 값 중 가장 큰 값과 자신이 졌다는 의미의 [false, cnt]를 리턴한다.

dfs를 거슬러 올라갈수록 게임의 이전 단계로 회귀한다. 그러다 보면 아직 승패가 정해지지 않은 단계까지 올 것이다. 이 단계에서 bRes에는 승패가 혼재되어 있다. 해당 가지의 해당 단계에서는 아직 승패가 확실히 결정되지 않은 것이다. 이러한 경우 각각의 플레이어는 서로 이기기 위한 최선의 수를 두어야 한다. 따라서 본인이 이기는 경우, 즉 bRes의 승패 값이 false이면서 cnt 값이 가장 작은 경우를 선택해 [true, cnt]를 리턴한다.

이러한 과정을 반복하면 최종적으로 처음 호출했던 A가 이겼는지 졌는지와, 최종 cnt값이 반환된다. 정리하면 cnt 값은 위의 과정을 통해 다음과 같은 조건을 만족했다.

1. 승리할 가능성이 있는 플레이어는 본인이 이기면서 최소 cnt의 경우의 수를 선택함.

2. 패배할 수밖에 없는 플레이어는 최대 cnt 경우의 수를 선택함.
